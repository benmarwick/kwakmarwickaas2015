make_C16_C18_scatter_plot(CSIA_KM_and_SS) +
geom_text(aes(label = Sample.No.), hjust = 0, vjust = 0)
# Chunk 4
# big_delta <- d18 - d16
big_delta <- CSIA_KM_and_SS$C18.0 - CSIA_KM_and_SS$C16.0
big_delta <- data.frame(big_delta = big_delta,
C16.0 = CSIA_KM_and_SS$C16.0,
Site = CSIA_KM_and_SS$ID,
sample_ID = CSIA_KM_and_SS$Sample.No.)
# plot
ggplot(big_delta, aes(C16.0, big_delta, colour = Site)) +
geom_point(size = 4) +
xlab(bquote(delta*{}^13*"C 16:0 \u2030")) +
ylab(bquote(Delta*{}^13*"C \u2030")) +
xlim(-40,-10) +
theme_minimal(base_size = 14) +
scale_y_continuous(breaks=seq(-10, 5, 1)) +
scale_color_manual(values = viridis(length(unique(big_delta$Site)))) # +
# geom_text(aes(label = sample_ID), hjust = 0, vjust = 0)
# SOS033 is the outlier at -8 Delta C18
# Chunk 4
sessionInfo()
setwd("D:/My Documents/My Papers/Archaeological and Anthropological Sciences/kwakmarwickjas2015/analysis")
# Chunk 2
library(kwakmarwick2015)
knitr::opts_chunk$set(cache = TRUE)
# Chunk 4
# read data in, three columns Name = lab code, Date = radiocarbon age, Uncertainty =  error
dates_KM <- read.csv('data/radiocarbon_KM.csv', stringsAsFactors = FALSE)
dates_SS <- read.csv('data/radiocarbon_SS.csv', stringsAsFactors = FALSE)
# make date names
dates_KM$Name <- paste0("KM_", dates_KM[,1])
dates_SS$Name <- paste0("SS_", dates_SS[,1])
# remove spaces
dates_KM$Name <- gsub("[[:space:]]", "_", dates_KM$Name)
dates_SS$Name <- gsub("[[:space:]]", "_", dates_SS$Name)
# split age and error term
library(stringr)
# KM
date_split  <- str_split_fixed(dates_KM$C14.date..BP..uncalibrated., "pm", 2)
date_split_Age <- as.numeric(gsub("[^0-9]", "", date_split[, 1]))
date_split_Error <- as.numeric(gsub("[^0-9]", "", date_split[, 2]))
# combine into data frame
dates_KM <- data.frame(Name = dates_KM$Name,
Date = date_split_Age,
Uncertainty = date_split_Error)
# SS
date_split  <- str_split_fixed(dates_SS$C14.date..BP..uncalibrated., "\\?\\?", 2)
date_split_Age <- as.numeric(gsub("[^0-9]", "", date_split[, 1]))
date_split_Error <- as.numeric(gsub("[^0-9]", "", date_split[, 2]))
# combine into data frame
dates_SS <- data.frame(Name = dates_SS$Name,
Date = date_split_Age,
Uncertainty = date_split_Error)
# combine all dates into one
dates <- rbind(dates_KM, dates_SS)
dates <- dates[complete.cases(dates), ]
# use the R package BChron...
library(Bchron)
# remove NAs
dates_SS <- dates_SS[complete.cases(dates_SS),]
# get estimation of activity through age as proxy
Dens_KM = BchronDensity(ages=dates_KM$Date, ageSds=dates_KM$Uncertainty, calCurves=rep('intcal13', nrow(dates_KM)))
Dens_SS = BchronDensity(ages=dates_SS$Date, ageSds=dates_SS$Uncertainty, calCurves=rep('intcal13', nrow(dates_SS)))
# get line for plotting
Dens_KM_plot <- BchronDensity_plot_params("KM", Dens_KM)
Dens_SS_plot <- BchronDensity_plot_params("SS", Dens_SS)
plot_all <- rbind(Dens_KM_plot, Dens_SS_plot)
# Chunk 4
library(ggplot2)
library(viridis)
ggplot(plot_all, aes(dateGrid, densFinal, colour = ID)) +
geom_line(size = 0.5) +
theme_minimal(base_size = 14) +
xlab("calibrated years BP") +
ylab("Density") +
xlim(1000,4000) +
scale_color_manual(values = viridis(length(unique(plot_all$ID))))
# Chunk 4
# Input data from csv file
SOS049 <-  read.csv(file="data/GC-MS_exported_data_Figure5a.CSV", header=TRUE, sep=",")
make_retention_times_plot(SOS049)
# Chunk 4
# Input data from csv file
KIM061 <- read.csv(file="data/GC-MS_exported_data_Figure5b.CSV", header=TRUE, sep=",")
make_retention_times_plot_no_labels(KIM061)
# Chunk 4
# read in data
CSIA_KM <- read.csv('data/CSIA_KM.csv', stringsAsFactors = FALSE)
CSIA_SS <- read.csv('data/CSIA_SS.csv', stringsAsFactors = FALSE)
# combine both into one dataframe
CSIA_KM_and_SS <- rbind(CSIA_KM, CSIA_SS)
# get site ID to control plotting colour and shape
CSIA_KM_and_SS$ID <- substr(CSIA_KM_and_SS$Sample.No., 1, 2)
# draw plot
make_C16_C18_scatter_plot(CSIA_KM_and_SS) +
geom_text(aes(label = Sample.No.), hjust = 0, vjust = 0)
# Chunk 4
# big_delta <- d18 - d16
big_delta <- CSIA_KM_and_SS$C18.0 - CSIA_KM_and_SS$C16.0
big_delta <- data.frame(big_delta = big_delta,
C16.0 = CSIA_KM_and_SS$C16.0,
Site = CSIA_KM_and_SS$ID,
sample_ID = CSIA_KM_and_SS$Sample.No.)
# plot
ggplot(big_delta, aes(C16.0, big_delta, colour = Site)) +
geom_point(size = 4) +
xlab(bquote(delta*{}^13*"C 16:0 \u2030")) +
ylab(bquote(Delta*{}^13*"C \u2030")) +
xlim(-40,-10) +
theme_minimal(base_size = 14) +
scale_y_continuous(breaks=seq(-10, 5, 1)) +
scale_color_manual(values = viridis(length(unique(big_delta$Site)))) # +
# geom_text(aes(label = sample_ID), hjust = 0, vjust = 0)
# SOS033 is the outlier at -8 Delta C18
# Chunk 4
sessionInfo()
View(CSIA_KM_and_SS)
View(big_delta)
make_C16_C18_scatter_plot(CSIA_KM_and_SS) +
geom_text(aes(label = Sample.No.), hjust = 0, vjust = 0)
make_C16_C18_scatter_plot(CSIA_KM_and_SS) +
geom_text(aes(label = Sample.No.), hjust = 0, vjust = 0)
library(kwakmarwick2015)
make_C16_C18_scatter_plot(CSIA_KM_and_SS) +
geom_text(aes(label = Sample.No.), hjust = 0, vjust = 0)
ggplot(big_delta, aes(C16.0, big_delta, colour = Site)) +
geom_point(size = 4) +
xlab(bquote(delta*{}^13*"C 16:0 \u2030")) +
ylab(bquote(Delta*{}^13*"C \u2030")) +
xlim(-40,-10) +
theme_minimal(base_size = 14) +
scale_y_continuous(breaks=seq(-10, 5, 1)) +
scale_color_manual(values = viridis(length(unique(big_delta$Site)))) # +
geom_text(aes(label = sample_ID), hjust = 0, vjust = 0)
ggplot(big_delta, aes(C16.0, big_delta, colour = Site)) +
geom_point(size = 4) +
xlab(bquote(delta*{}^13*"C 16:0 \u2030")) +
ylab(bquote(Delta*{}^13*"C \u2030")) +
xlim(-40,-10) +
theme_minimal(base_size = 14) +
scale_y_continuous(breaks=seq(-10, 5, 1)) +
scale_color_manual(values = viridis(length(unique(big_delta$Site))))  +
geom_text(aes(label = sample_ID), hjust = 0, vjust = 0)
setwd("G:/My Documents/My Papers/Archaeological and Anthropological Sciences/kwakmarwickjas2015/analysis")
source('~/.active-rstudio-document', encoding = 'UTF-8', echo=TRUE)
View(CSIA_KM)
CSIA_KM
CSIA_SS
containing_lipid_residues <- c(nrow(CSIA_KM), nrow(CSIA_SS))
containing_lipid_residues
total_sherds <- c(49, 37)
total_sherds
percentage_containing_lipid_residues <- containing_lipid_residues / total_sherds * 100
percentage_containing_lipid_residues
percentage_containing_lipid_residues <- round((containing_lipid_residues / total_sherds * 100), 0)
percentage_containing_lipid_residues
mean(c(41, 76))
nrow(CSIA_KM)
nrow(CSIA_SS)
containing_lipid_residues <- c(nrow(CSIA_KM), nrow(CSIA_SS))
sum(containing_lipid_residues)
sum(total_sherds)
(containing_lipid_residues / total_sherds * 100)
48/86
max(CSIA_KM$Lipid.concentration..ng.g.1.)
max(CSIA_SS$Lipid.concentration..ng.g.1.)
lipid_concentrations_ng_max <- c(max(CSIA_KM$Lipid.concentration..ng.g.1.),
max(CSIA_SS$Lipid.concentration..ng.g.1.)
)
(mean(CSIA_KM$Lipid.concentration..ng.g.1.),
mean(CSIA_SS$Lipid.concentration..ng.g.1.))
(mean(CSIA_KM$Lipid.concentration..ng.g.1.),
mean(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_ng_mean <- c(mean(CSIA_KM$Lipid.concentration..ng.g.1.),
mean(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_ng_max <- c(max(CSIA_KM$Lipid.concentration..ng.g.1.),
max(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_ng_mean <- c(mean(CSIA_KM$Lipid.concentration..ng.g.1.),
mean(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_ng_mean
10e3
lipid_concentrations_mg_max <-  lipid_concentrations_ng_max / 10e6
lipid_concentrations_mg_max
lipid_concentrations_mg_mean <- lipid_concentrations_ng_mean / 10e6
lipid_concentrations_mg_mean
lipid_concentrations_mg_max <-  round(lipid_concentrations_ng_max / 10e6, 3)
lipid_concentrations_mg_max <-  round(lipid_concentrations_ng_max / 10e6, 3)
lipid_concentrations_mg_max
lipid_concentrations_mg_mean <- round(lipid_concentrations_ng_mean / 10e6, 3)
lipid_concentrations_mg_mean
site_names <- c("Kimpo-Yngchon", "Sosa-Dong")
containing_lipid_residues <- c(nrow(CSIA_KM), nrow(CSIA_SS))
total_sherds <- c(49, 37)
percentage_containing_lipid_residues <- round((containing_lipid_residues / total_sherds * 100), 0)
lipid_concentrations_ng_max <- c(max(CSIA_KM$Lipid.concentration..ng.g.1.),
max(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_ng_mean <- c(mean(CSIA_KM$Lipid.concentration..ng.g.1.),
mean(CSIA_SS$Lipid.concentration..ng.g.1.))
lipid_concentrations_mg_max <-  round(lipid_concentrations_ng_max / 10e6, 3)
lipid_concentrations_mg_mean <- round(lipid_concentrations_ng_mean / 10e6, 3)
library(htmlTable)
ncol=4, byrow = TRUE)
output <-
matrix(paste("Content", LETTERS[1:16]),
ncol=4, byrow = TRUE)
library(htmlTable)
output <-
matrix(paste("Content", LETTERS[1:16]),
ncol=4, byrow = TRUE)
library(htmlTable)
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = c("Group A",
"Group B"),
n.rgroup = c(2,2),
cgroup = c("Cgroup 1", "Cgroup 2&dagger;"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
summary_table <- data.frame(
`Site` = site_names,
`Total number of sherds` = total_sherds,
`Sherds containing lipid residues` = containing_lipid_residues,
`Percentage containing residues` = percentage_containing_lipid_residues,
`Lipid concentrations mg max` = lipid_concentrations_mg_max,
`Lipid concentrations mg mean` = lipid_concentrations_mg_mean
)
summary_table
summary_table <- data.frame(
site_names,
total_sherds,
containing_lipid_residues,
percentage_containing_lipid_residues,
lipid_concentrations_mg_max,
lipid_concentrations_mg_mean
)
summary_table
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
n.rgroup = c(2,2),
cgroup = c("Cgroup 1", "Cgroup 2&dagger;"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Cgroup 1", "Cgroup 2&dagger;"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g^−1)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header =  "",
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
# header =  "",
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header =  paste(c("1st", "2nd",
"3rd", "4th"), "header"),
rnames = paste(c("1st", "2nd",
"3rd", "4th"), "row"),
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
library(htmlTable)
htmlTable(output,
header = c("Total", "Containing lipid residues",
"Maximum", "Mean"),
rnames = site_names,
rgroup = "",
n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header = c("Total", "Containing lipid residues",
"Maximum", "Mean"),
rnames = site_names,
rgroup = "",
# n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(output,
header = c("Total", "Containing lipid residues",
"Maximum", "Mean"),
rnames = site_names,
# rgroup = "",
# n.rgroup = c(2,2),
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
summary_table <- data.frame( total_sherds,
containing_lipid_residues,
percentage_containing_lipid_residues,
lipid_concentrations_mg_max,
lipid_concentrations_mg_mean)
htmlTable(summary_table,
header = c("Total", "Containing lipid residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(summary_table,
header = c("Total", "Containing lipid residues", "Percentage containing residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(summary_table,
header = c("Total", "Containing lipid residues", "Percentage containing residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(3,2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(summary_table,
header = c("Total", "Containing lipid residues", "Percentage containing residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(3, 1, 2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(summary_table,
header = c("Total", "Containing lipid residues", "Percentage containing residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2, 1, 2),
caption="Basic table with both column spanners (groups) and row groups",
tfoot="&dagger; A table footer commment")
htmlTable(summary_table,
header = c("Total", "Containing lipid residues", "Percentage containing residues",
"Maximum", "Mean"),
rnames = site_names,
cgroup = c("Number of sherds", "", "Lipid concentrations (mg g<sup>−1</sup>)"),
n.cgroup = c(2, 1, 2),
caption="Number of sherds containing lipids and their concentrations")
M <- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))
dimnames(M) <- list(gender = c("F", "M"),
party = c("Democrat","Independent", "Republican"))
(Xsq <- chisq.test(M))  # Prints test summary
Xsq$observed   # observed counts (same as M)
Xsq$expected   # expected counts under the null
Xsq$residuals  # Pearson residuals
Xsq$stdres     # standardized residuals
M <- as.table(rbind(total_sherds, containing_lipid_residues))
M
M <- as.table(rbind(total_sherds, containing_lipid_residues))
dimnames(M) <- list(site = c("KM", "SS"),
condition = c("total","containing"))
M
M <- as.table(cbind(total_sherds, containing_lipid_residues))
dimnames(M) <- list(site = c("KM", "SS"),
condition = c("total","containing"))
M
(Xsq <- chisq.test(M))  # Prints test summary
chisq.test(Xsq)$p.value
chisq.test(M)$p.value
chisq.test(M, simulate.p.value = TRUE, B = 10000)$p.value
chi_sq_M <- chisq.test(M, simulate.p.value = TRUE, B = 10000)$p.value
chi_sq_M <- chisq.test(M, simulate.p.value = TRUE, B = 10000)
chi_sq_M_pvalue <- chi_sq_M$p.value
chi_sq_M_pvalue
chi_sq_M_chivalue <- chi_sq_M$statistic
chi_sq_M_chivalue
unname(chi_sq_M$statistic)
chi_sq_M_pvalue <- round(chi_sq_M$p.value, 3)
chi_sq_M_pvalue
unname(round(chi_sq_M$statistic), 3)
chi_sq_M_chivalue
unname(round(chi_sq_M$statistic, 3))
lipid_concentrations_diff <- t.test(CSIA_KM$Lipid.concentration..ng.g.1.,
CSIA_SS$Lipid.concentration..ng.g.1.)
lipid_concentrations_diff
CSIA_SS$Lipid.concentration..ng.g.1.))
stack(list(CSIA_KM$Lipid.concentration..ng.g.1.,
CSIA_SS$Lipid.concentration..ng.g.1.))
stack(c(CSIA_KM$Lipid.concentration..ng.g.1.,
CSIA_SS$Lipid.concentration..ng.g.1.))
list(CSIA_KM$Lipid.concentration..ng.g.1.,
CSIA_SS$Lipid.concentration..ng.g.1.)
stack(list(CSIA_KM$Lipid.concentration..ng.g.1.,
CSIA_SS$Lipid.concentration..ng.g.1.))
stack(list(KM= CSIA_KM$Lipid.concentration..ng.g.1.,
SS = CSIA_SS$Lipid.concentration..ng.g.1.))
concs <- stack(list(KM= CSIA_KM$Lipid.concentration..ng.g.1.,
SS = CSIA_SS$Lipid.concentration..ng.g.1.))
concs
ggplot(concs, aes(values, group = ind)) +
geom_density()
ggplot(concs, aes(y = values, group = ind)) +
geom_density()
ggplot(concs, aes(y = values, x = ind)) +
geom_violin()
ggplot(concs, aes(y = values, x = ind)) +
geom_violin() +
ylab("Lipid concentration (ng/g")
ggplot(concs, aes(y = values, x = ind)) +
geom_violin() +
ylab("Lipid concentration (ng/g)") +
theme_minimal()
ggplot(concs, aes(y = values, x = ind)) +
geom_violin() +
ylab("Lipid concentration (ng/g)") +
xlab("Site") +
theme_minimal()
CSIA_KM$Lipid.concentration..ng.g.1.
CSIA_SS$Lipid.concentration..ng.g.1.
mean(CSIA_KM$Lipid.concentration..ng.g.1.)
mean(CSIA_SS$Lipid.concentration..ng.g.1.)
lipid_concentrations_diff$statistic
unname(round(lipid_concentrations_diff$statistic, 3))
lipid_concentrations_diff_p <- unname(round(lipid_concentrations_diff$p.value, 3))
lipid_concentrations_diff_p
lipid_concentrations_diff_t <- unname(round(lipid_concentrations_diff$statistic, 3))
lipid_concentrations_diff_t
M
sum(M)
total_sherds-containing_lipid_residues
M <- as.table(cbind((total_sherds-containing_lipid_residues),
containing_lipid_residues))
M
"KM", "SS"
"KM", "SS"
dimnames(M) <- list(site = c("KM", "SS"),
condition = c("not_containing","containing"))
M
28+9
chi_sq_M <- chisq.test(M, simulate.p.value = TRUE, B = 10000)
chi_sq_M_chivalue <- unname(round(chi_sq_M$statistic, 3))
chi_sq_M_pvalue <- round(chi_sq_M$p.value, 3)
chi_sq_M_pvalue
chi_sq_M_chivalue
chi_df <- nrow(M)-1 * ncol(M)-1
chi_df
ncol(M)
nrow(M)-1
chi_df <- (nrow(M)-1) * (ncol(M)-1)
chi_df
sum(M)
lipid_concentrations_diff
lipid_concentrations_diff$method
